# WebGL Reftests!
default-preferences pref(webgl.force-enabled,true)

# Check that disabling works:
                           == webgl-disable-test.html?nogl  wrapper.html?green.png
pref(webgl.disabled,true)  == webgl-disable-test.html       wrapper.html?green.png

# Basic WebGL tests:
# Do we get pixels to the screen at all?
== webgl-clear-test.html wrapper.html?green.png

# Check that resize works:
== webgl-resize-test.html  wrapper.html?green.png

# Does we draw the correct color in the correct places with all context creation options?
# (Note that our context creation option matrix is 2^6 = 64)
random-if(B2G)  == webgl-color-test.html?__&_____&_____&_______&________&_______  wrapper.html?colors.png # Bug 844439
random-if(B2G)  == webgl-color-test.html?aa&_____&_____&_______&________&_______  wrapper.html?colors.png # Bug 844439
random-if(gtk2Widget) random-if(B2G)  == webgl-color-test.html?__&alpha&_____&_______&________&_______  wrapper.html?colors.png # Bug 844439
random-if(gtk2Widget) random-if(B2G)  == webgl-color-test.html?aa&alpha&_____&_______&________&_______  wrapper.html?colors.png # Bug 844439
random-if(B2G)  == webgl-color-test.html?__&_____&depth&_______&________&_______  wrapper.html?colors.png # Bug 844439
random-if(B2G)  == webgl-color-test.html?aa&_____&depth&_______&________&_______  wrapper.html?colors.png # Bug 844439
random-if(gtk2Widget) random-if(B2G)  == webgl-color-test.html?__&alpha&depth&_______&________&_______  wrapper.html?colors.png # Bug 844439
random-if(gtk2Widget) random-if(B2G)  == webgl-color-test.html?aa&alpha&depth&_______&________&_______  wrapper.html?colors.png # Bug 844439
random-if(B2G)  == webgl-color-test.html?__&_____&_____&premult&________&_______  wrapper.html?colors.png # Bug 844439
random-if(B2G)  == webgl-color-test.html?aa&_____&_____&premult&________&_______  wrapper.html?colors.png # Bug 844439
random-if(gtk2Widget) random-if(B2G)  == webgl-color-test.html?__&alpha&_____&premult&________&_______  wrapper.html?colors.png # Bug 844439
random-if(gtk2Widget) random-if(B2G)  == webgl-color-test.html?aa&alpha&_____&premult&________&_______  wrapper.html?colors.png # Bug 844439
random-if(B2G)  == webgl-color-test.html?__&_____&depth&premult&________&_______  wrapper.html?colors.png # Bug 844439
random-if(B2G)  == webgl-color-test.html?aa&_____&depth&premult&________&_______  wrapper.html?colors.png # Bug 844439
random-if(gtk2Widget) random-if(B2G)  == webgl-color-test.html?__&alpha&depth&premult&________&_______  wrapper.html?colors.png # Bug 844439
random-if(gtk2Widget) random-if(B2G)  == webgl-color-test.html?aa&alpha&depth&premult&________&_______  wrapper.html?colors.png # Bug 844439

random-if(B2G)  == webgl-color-test.html?__&_____&_____&_______&preserve&_______  wrapper.html?colors.png # Bug 844439
random-if(B2G)  == webgl-color-test.html?aa&_____&_____&_______&preserve&_______  wrapper.html?colors.png # Bug 844439
random-if(gtk2Widget) random-if(B2G)  == webgl-color-test.html?__&alpha&_____&_______&preserve&_______  wrapper.html?colors.png # Bug 844439
random-if(gtk2Widget) random-if(B2G)  == webgl-color-test.html?aa&alpha&_____&_______&preserve&_______  wrapper.html?colors.png # Bug 844439
random-if(B2G)  == webgl-color-test.html?__&_____&depth&_______&preserve&_______  wrapper.html?colors.png # Bug 844439
random-if(B2G)  == webgl-color-test.html?aa&_____&depth&_______&preserve&_______  wrapper.html?colors.png # Bug 844439
random-if(gtk2Widget) random-if(B2G)  == webgl-color-test.html?__&alpha&depth&_______&preserve&_______  wrapper.html?colors.png # Bug 844439
random-if(gtk2Widget) random-if(B2G)  == webgl-color-test.html?aa&alpha&depth&_______&preserve&_______  wrapper.html?colors.png # Bug 844439
random-if(B2G)  == webgl-color-test.html?__&_____&_____&premult&preserve&_______  wrapper.html?colors.png # Bug 844439
random-if(B2G)  == webgl-color-test.html?aa&_____&_____&premult&preserve&_______  wrapper.html?colors.png # Bug 844439
random-if(gtk2Widget) random-if(B2G)  == webgl-color-test.html?__&alpha&_____&premult&preserve&_______  wrapper.html?colors.png # Bug 844439
random-if(gtk2Widget) random-if(B2G)  == webgl-color-test.html?aa&alpha&_____&premult&preserve&_______  wrapper.html?colors.png # Bug 844439
random-if(B2G)  == webgl-color-test.html?__&_____&depth&premult&preserve&_______  wrapper.html?colors.png # Bug 844439
random-if(B2G)  == webgl-color-test.html?aa&_____&depth&premult&preserve&_______  wrapper.html?colors.png # Bug 844439
random-if(gtk2Widget) random-if(B2G)  == webgl-color-test.html?__&alpha&depth&premult&preserve&_______  wrapper.html?colors.png # Bug 844439
random-if(gtk2Widget) random-if(B2G)  == webgl-color-test.html?aa&alpha&depth&premult&preserve&_______  wrapper.html?colors.png # Bug 844439

random-if(B2G)  == webgl-color-test.html?__&_____&_____&_______&________&stencil  wrapper.html?colors.png # Bug 844439
random-if(B2G)  == webgl-color-test.html?aa&_____&_____&_______&________&stencil  wrapper.html?colors.png # Bug 844439
random-if(gtk2Widget) random-if(B2G)  == webgl-color-test.html?__&alpha&_____&_______&________&stencil  wrapper.html?colors.png # Bug 844439
random-if(gtk2Widget) random-if(B2G)  == webgl-color-test.html?aa&alpha&_____&_______&________&stencil  wrapper.html?colors.png # Bug 844439
random-if(B2G)  == webgl-color-test.html?__&_____&depth&_______&________&stencil  wrapper.html?colors.png # Bug 844439
random-if(B2G)  == webgl-color-test.html?aa&_____&depth&_______&________&stencil  wrapper.html?colors.png # Bug 844439
random-if(gtk2Widget) random-if(B2G)  == webgl-color-test.html?__&alpha&depth&_______&________&stencil  wrapper.html?colors.png # Bug 844439
random-if(gtk2Widget) random-if(B2G)  == webgl-color-test.html?aa&alpha&depth&_______&________&stencil  wrapper.html?colors.png # Bug 844439
random-if(B2G)  == webgl-color-test.html?__&_____&_____&premult&________&stencil  wrapper.html?colors.png # Bug 844439
random-if(B2G)  == webgl-color-test.html?aa&_____&_____&premult&________&stencil  wrapper.html?colors.png # Bug 844439
random-if(gtk2Widget) random-if(B2G)  == webgl-color-test.html?__&alpha&_____&premult&________&stencil  wrapper.html?colors.png # Bug 844439
random-if(gtk2Widget) random-if(B2G)  == webgl-color-test.html?aa&alpha&_____&premult&________&stencil  wrapper.html?colors.png # Bug 844439
random-if(B2G)  == webgl-color-test.html?__&_____&depth&premult&________&stencil  wrapper.html?colors.png # Bug 844439
random-if(B2G)  == webgl-color-test.html?aa&_____&depth&premult&________&stencil  wrapper.html?colors.png # Bug 844439
random-if(gtk2Widget) random-if(B2G)  == webgl-color-test.html?__&alpha&depth&premult&________&stencil  wrapper.html?colors.png # Bug 844439
random-if(gtk2Widget) random-if(B2G)  == webgl-color-test.html?aa&alpha&depth&premult&________&stencil  wrapper.html?colors.png # Bug 844439

random-if(B2G)  == webgl-color-test.html?__&_____&_____&_______&preserve&stencil  wrapper.html?colors.png # Bug 844439
random-if(B2G)  == webgl-color-test.html?aa&_____&_____&_______&preserve&stencil  wrapper.html?colors.png # Bug 844439
random-if(gtk2Widget) random-if(B2G)  == webgl-color-test.html?__&alpha&_____&_______&preserve&stencil  wrapper.html?colors.png # Bug 844439
random-if(gtk2Widget) random-if(B2G)  == webgl-color-test.html?aa&alpha&_____&_______&preserve&stencil  wrapper.html?colors.png # Bug 844439
random-if(B2G)  == webgl-color-test.html?__&_____&depth&_______&preserve&stencil  wrapper.html?colors.png # Bug 844439
random-if(B2G)  == webgl-color-test.html?aa&_____&depth&_______&preserve&stencil  wrapper.html?colors.png # Bug 844439
random-if(gtk2Widget) random-if(B2G)  == webgl-color-test.html?__&alpha&depth&_______&preserve&stencil  wrapper.html?colors.png # Bug 844439
random-if(gtk2Widget) random-if(B2G)  == webgl-color-test.html?aa&alpha&depth&_______&preserve&stencil  wrapper.html?colors.png # Bug 844439
random-if(B2G)  == webgl-color-test.html?__&_____&_____&premult&preserve&stencil  wrapper.html?colors.png # Bug 844439
random-if(B2G)  == webgl-color-test.html?aa&_____&_____&premult&preserve&stencil  wrapper.html?colors.png # Bug 844439
random-if(gtk2Widget) random-if(B2G)  == webgl-color-test.html?__&alpha&_____&premult&preserve&stencil  wrapper.html?colors.png # Bug 844439
random-if(gtk2Widget) random-if(B2G)  == webgl-color-test.html?aa&alpha&_____&premult&preserve&stencil  wrapper.html?colors.png # Bug 844439
random-if(B2G)  == webgl-color-test.html?__&_____&depth&premult&preserve&stencil  wrapper.html?colors.png # Bug 844439
random-if(B2G)  == webgl-color-test.html?aa&_____&depth&premult&preserve&stencil  wrapper.html?colors.png # Bug 844439
random-if(gtk2Widget) random-if(B2G)  == webgl-color-test.html?__&alpha&depth&premult&preserve&stencil  wrapper.html?colors.png # Bug 844439
random-if(gtk2Widget) random-if(B2G)  == webgl-color-test.html?aa&alpha&depth&premult&preserve&stencil  wrapper.html?colors.png # Bug 844439


# Check a smaller selection for readback:
pref(webgl.force-layers-readback,true) random-if(B2G)  == webgl-color-test.html?readback&__&_____&________  wrapper.html?colors.png # Bug 844439
pref(webgl.force-layers-readback,true) random-if(B2G)  == webgl-color-test.html?readback&aa&_____&________  wrapper.html?colors.png # Bug 844439
random-if(gtk2Widget) pref(webgl.force-layers-readback,true) random-if(B2G)  == webgl-color-test.html?readback&__&alpha&________  wrapper.html?colors.png # Bug 844439
random-if(gtk2Widget) pref(webgl.force-layers-readback,true) random-if(B2G)  == webgl-color-test.html?readback&aa&alpha&________  wrapper.html?colors.png # Bug 844439
pref(webgl.force-layers-readback,true) random-if(B2G)  == webgl-color-test.html?readback&__&_____&preserve  wrapper.html?colors.png # Bug 844439
pref(webgl.force-layers-readback,true) random-if(B2G)  == webgl-color-test.html?readback&aa&_____&preserve  wrapper.html?colors.png # Bug 844439
random-if(gtk2Widget) pref(webgl.force-layers-readback,true) random-if(B2G)  == webgl-color-test.html?readback&__&alpha&preserve  wrapper.html?colors.png # Bug 844439
random-if(gtk2Widget) pref(webgl.force-layers-readback,true) random-if(B2G)  == webgl-color-test.html?readback&aa&alpha&preserve  wrapper.html?colors.png # Bug 844439


# Check alpha behavior:
fuzzy-if(B2G,256,83)  == webgl-color-alpha-test.html?colorVal=1.0&alphaVal=1.0  wrapper.html?colors.png
# These tests don't use wrapper.html, as there appear to be invalidation issues with black.png and async image decoding - Bug 803299
 == webgl-color-alpha-test.html?colorVal=0.0&alphaVal=1.0  black.html

fuzzy-if(B2G,256,83)  == webgl-color-alpha-test.html?colorVal=1.0&alphaVal=0.0        wrapper.html?colors.png
 == webgl-color-alpha-test.html?colorVal=1.0&alphaVal=0.0&alpha  wrapper.html?white.png

fuzzy(1,65536) fuzzy-if(B2G,256,83) fuzzy-if(Android||B2G,9,65536)  == webgl-color-alpha-test.html?colorVal=0.5&alphaVal=1.0  wrapper.html?half-colors.png

# Test premult:
# random-if(B2G) from bug 983650
# Mark as failing on WinXP (winWidget&&!d2d), because Try said so. WFM outside of Try.
# This might work on WinXP again if OMTC is disabled.
fuzzy(1,65536) random-if(gtk2Widget) random-if(winWidget&&!d2d) random-if(B2G) fuzzy-if(Android,9,65536)  == webgl-color-alpha-test.html?colorVal=1.0&alphaVal=0.5&alpha          wrapper.html?colors-half-alpha.png
fuzzy(1,65536) random-if(gtk2Widget) fails-if(winWidget&&!d2d)                 fuzzy-if(Android,9,65536)  == webgl-color-alpha-test.html?colorVal=0.5&alphaVal=0.5&alpha          wrapper.html?half-colors-half-alpha.png
# random-if(B2G) from bug 983650
fuzzy(1,65536)                       random-if(B2G) fuzzy-if(Android,9,65536)  == webgl-color-alpha-test.html?colorVal=0.5&alphaVal=0.5&alpha&premult  wrapper.html?colors-half-alpha.png

# Check for hanging framebuffer bindings:
                                        == webgl-hanging-fb-test.html?__&________  wrapper.html?green.png
                                        == webgl-hanging-fb-test.html?aa&________  wrapper.html?green.png
pref(webgl.force-layers-readback,true)  == webgl-hanging-fb-test.html?__&readback  wrapper.html?green.png
pref(webgl.force-layers-readback,true)  == webgl-hanging-fb-test.html?aa&readback  wrapper.html?green.png

                                        == webgl-hanging-scissor-test.html?__&________  wrapper.html?green.png
                                        == webgl-hanging-scissor-test.html?aa&________  wrapper.html?green.png
pref(webgl.force-layers-readback,true)  == webgl-hanging-scissor-test.html?__&readback  wrapper.html?green.png
pref(webgl.force-layers-readback,true)  == webgl-hanging-scissor-test.html?aa&readback  wrapper.html?green.png


# Check that our experimental prefs still work:

# 16bpp:
skip-if(winWidget) pref(webgl.prefer-16bpp,true)                                         == webgl-color-test.html?16bpp           wrapper.html?colors.png
skip-if(winWidget) pref(webgl.prefer-16bpp,true) pref(webgl.force-layers-readback,true)  == webgl-color-test.html?16bpp&readback  wrapper.html?colors.png

# Force native GL (Windows):
skip-if(!winWidget) pref(webgl.disable-angle,true)                                == webgl-clear-test.html?native-gl        wrapper.html?green.png
skip-if(!winWidget) pref(webgl.disable-angle,true)                                == webgl-orientation-test.html?native-gl  wrapper.html?white-top-left.png
skip-if(!winWidget) pref(webgl.disable-angle,true)                                == webgl-color-test.html?native-gl        wrapper.html?colors.png
skip-if(!winWidget) pref(webgl.disable-angle,true) pref(webgl.prefer-16bpp,true)  == webgl-color-test.html?native-gl&16bpp  wrapper.html?colors.png


# Non-WebGL Reftests!

# Do we correctly handle multiple clip paths?
!= clip-multiple-paths.html clip-multiple-paths-badref.html

# Bug 815648
== stroketext-shadow.html stroketext-shadow-ref.html

# focus rings
pref(canvas.focusring.enabled,true) skip-if(B2G) skip-if(Android&&AndroidVersion<15,8,500) skip-if(winWidget) needs-focus == drawFocusIfNeeded.html drawFocusIfNeeded-ref.html
pref(canvas.customfocusring.enabled,true) skip-if(B2G) skip-if(Android&&AndroidVersion<15,8,500) skip-if(winWidget) needs-focus == drawCustomFocusRing.html drawCustomFocusRing-ref.html
