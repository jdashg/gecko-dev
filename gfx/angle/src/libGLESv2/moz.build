
# Please note this file is autogenerated from generate_mozbuild.py, so do not modify it directly

UNIFIED_SOURCES += [
    '../common/angleutils.cpp',
    '../common/debug.cpp',
    '../common/event_tracer.cpp',
    '../common/Float16ToFloat32.cpp',
    '../common/mathutil.cpp',
    '../common/MemoryBuffer.cpp',
    '../common/string_utils.cpp',
    '../common/tls.cpp',
    '../common/utilities.cpp',
    '../compiler/preprocessor/DiagnosticsBase.cpp',
    '../compiler/preprocessor/DirectiveHandlerBase.cpp',
    '../compiler/preprocessor/DirectiveParser.cpp',
    '../compiler/preprocessor/ExpressionParser.cpp',
    '../compiler/preprocessor/Input.cpp',
    '../compiler/preprocessor/Lexer.cpp',
    '../compiler/preprocessor/Macro.cpp',
    '../compiler/preprocessor/MacroExpander.cpp',
    '../compiler/preprocessor/Preprocessor.cpp',
    '../compiler/preprocessor/Token.cpp',
    '../compiler/preprocessor/Tokenizer.cpp',
    '../compiler/translator/ArrayReturnValueToOutParameter.cpp',
    '../compiler/translator/ASTMetadataHLSL.cpp',
    '../compiler/translator/blocklayout.cpp',
    '../compiler/translator/blocklayoutHLSL.cpp',
    '../compiler/translator/BuiltInFunctionEmulator.cpp',
    '../compiler/translator/BuiltInFunctionEmulatorGLSL.cpp',
    '../compiler/translator/BuiltInFunctionEmulatorHLSL.cpp',
    '../compiler/translator/Cache.cpp',
    '../compiler/translator/CallDAG.cpp',
    '../compiler/translator/CodeGen.cpp',
    '../compiler/translator/Compiler.cpp',
    '../compiler/translator/depgraph/DependencyGraph.cpp',
    '../compiler/translator/depgraph/DependencyGraphBuilder.cpp',
    '../compiler/translator/depgraph/DependencyGraphOutput.cpp',
    '../compiler/translator/depgraph/DependencyGraphTraverse.cpp',
    '../compiler/translator/Diagnostics.cpp',
    '../compiler/translator/DirectiveHandler.cpp',
    '../compiler/translator/EmulatePrecision.cpp',
    '../compiler/translator/FlagStd140Structs.cpp',
    '../compiler/translator/ForLoopUnroll.cpp',
    '../compiler/translator/InfoSink.cpp',
    '../compiler/translator/Initialize.cpp',
    '../compiler/translator/InitializeDll.cpp',
    '../compiler/translator/InitializeParseContext.cpp',
    '../compiler/translator/InitializeVariables.cpp',
    '../compiler/translator/Intermediate.cpp',
    '../compiler/translator/IntermNode.cpp',
    '../compiler/translator/intermOut.cpp',
    '../compiler/translator/IntermTraverse.cpp',
    '../compiler/translator/LoopInfo.cpp',
    '../compiler/translator/Operator.cpp',
    '../compiler/translator/OutputESSL.cpp',
    '../compiler/translator/OutputGLSL.cpp',
    '../compiler/translator/OutputGLSLBase.cpp',
    '../compiler/translator/OutputHLSL.cpp',
    '../compiler/translator/parseConst.cpp',
    '../compiler/translator/ParseContext.cpp',
    '../compiler/translator/PoolAlloc.cpp',
    '../compiler/translator/PruneEmptyDeclarations.cpp',
    '../compiler/translator/RecordConstantPrecision.cpp',
    '../compiler/translator/RegenerateStructNames.cpp',
    '../compiler/translator/RemovePow.cpp',
    '../compiler/translator/RemoveSwitchFallThrough.cpp',
    '../compiler/translator/RewriteElseBlocks.cpp',
    '../compiler/translator/ScalarizeVecAndMatConstructorArgs.cpp',
    '../compiler/translator/SearchSymbol.cpp',
    '../compiler/translator/SeparateArrayInitialization.cpp',
    '../compiler/translator/SeparateDeclarations.cpp',
    '../compiler/translator/SeparateExpressionsReturningArrays.cpp',
    '../compiler/translator/ShaderLang.cpp',
    '../compiler/translator/ShaderVars.cpp',
    '../compiler/translator/StructureHLSL.cpp',
    '../compiler/translator/SymbolTable.cpp',
    '../compiler/translator/timing/RestrictFragmentShaderTiming.cpp',
    '../compiler/translator/timing/RestrictVertexShaderTiming.cpp',
    '../compiler/translator/TranslatorESSL.cpp',
    '../compiler/translator/TranslatorGLSL.cpp',
    '../compiler/translator/TranslatorHLSL.cpp',
    '../compiler/translator/Types.cpp',
    '../compiler/translator/UnfoldShortCircuitAST.cpp',
    '../compiler/translator/UnfoldShortCircuitToIf.cpp',
    '../compiler/translator/UniformHLSL.cpp',
    '../compiler/translator/util.cpp',
    '../compiler/translator/UtilsHLSL.cpp',
    '../compiler/translator/ValidateGlobalInitializer.cpp',
    '../compiler/translator/ValidateLimitations.cpp',
    '../compiler/translator/ValidateOutputs.cpp',
    '../compiler/translator/ValidateSwitch.cpp',
    '../compiler/translator/VariableInfo.cpp',
    '../compiler/translator/VariablePacker.cpp',
    '../compiler/translator/VersionGLSL.cpp',
    '../libANGLE/angletypes.cpp',
    '../libANGLE/AttributeMap.cpp',
    '../libANGLE/Buffer.cpp',
    '../libANGLE/Caps.cpp',
    '../libANGLE/Compiler.cpp',
    '../libANGLE/Config.cpp',
    '../libANGLE/Context.cpp',
    '../libANGLE/Data.cpp',
    '../libANGLE/Device.cpp',
    '../libANGLE/Error.cpp',
    '../libANGLE/Fence.cpp',
    '../libANGLE/formatutils.cpp',
    '../libANGLE/Framebuffer.cpp',
    '../libANGLE/FramebufferAttachment.cpp',
    '../libANGLE/HandleAllocator.cpp',
    '../libANGLE/ImageIndex.cpp',
    '../libANGLE/IndexRangeCache.cpp',
    '../libANGLE/Platform.cpp',
    '../libANGLE/Program.cpp',
    '../libANGLE/Query.cpp',
    '../libANGLE/queryconversions.cpp',
    '../libANGLE/RefCountObject.cpp',
    '../libANGLE/Renderbuffer.cpp',
    '../libANGLE/renderer/d3d/BufferD3D.cpp',
    '../libANGLE/renderer/d3d/CompilerD3D.cpp',
    '../libANGLE/renderer/d3d/copyimage.cpp',
    '../libANGLE/renderer/d3d/d3d9/Blit9.cpp',
    '../libANGLE/renderer/d3d/d3d9/Buffer9.cpp',
    '../libANGLE/renderer/d3d/d3d9/DebugAnnotator9.cpp',
    '../libANGLE/renderer/d3d/d3d9/Fence9.cpp',
    '../libANGLE/renderer/d3d/d3d9/formatutils9.cpp',
    '../libANGLE/renderer/d3d/d3d9/Framebuffer9.cpp',
    '../libANGLE/renderer/d3d/d3d9/Image9.cpp',
    '../libANGLE/renderer/d3d/d3d9/IndexBuffer9.cpp',
    '../libANGLE/renderer/d3d/d3d9/Query9.cpp',
    '../libANGLE/renderer/d3d/d3d9/Renderer9.cpp',
    '../libANGLE/renderer/d3d/d3d9/renderer9_utils.cpp',
    '../libANGLE/renderer/d3d/d3d9/RenderTarget9.cpp',
    '../libANGLE/renderer/d3d/d3d9/ShaderExecutable9.cpp',
    '../libANGLE/renderer/d3d/d3d9/SwapChain9.cpp',
    '../libANGLE/renderer/d3d/d3d9/TextureStorage9.cpp',
    '../libANGLE/renderer/d3d/d3d9/VertexBuffer9.cpp',
    '../libANGLE/renderer/d3d/d3d9/VertexDeclarationCache.cpp',
    '../libANGLE/renderer/d3d/DeviceD3D.cpp',
    '../libANGLE/renderer/d3d/DisplayD3D.cpp',
    '../libANGLE/renderer/d3d/DynamicHLSL.cpp',
    '../libANGLE/renderer/d3d/formatutilsD3D.cpp',
    '../libANGLE/renderer/d3d/FramebufferD3D.cpp',
    '../libANGLE/renderer/d3d/ImageD3D.cpp',
    '../libANGLE/renderer/d3d/IndexBuffer.cpp',
    '../libANGLE/renderer/d3d/IndexDataManager.cpp',
    '../libANGLE/renderer/d3d/loadimage.cpp',
    '../libANGLE/renderer/d3d/ProgramD3D.cpp',
    '../libANGLE/renderer/d3d/RenderbufferD3D.cpp',
    '../libANGLE/renderer/d3d/RendererD3D.cpp',
    '../libANGLE/renderer/d3d/RenderTargetD3D.cpp',
    '../libANGLE/renderer/d3d/ShaderD3D.cpp',
    '../libANGLE/renderer/d3d/ShaderExecutableD3D.cpp',
    '../libANGLE/renderer/d3d/SurfaceD3D.cpp',
    '../libANGLE/renderer/d3d/TextureD3D.cpp',
    '../libANGLE/renderer/d3d/TransformFeedbackD3D.cpp',
    '../libANGLE/renderer/d3d/VertexBuffer.cpp',
    '../libANGLE/renderer/d3d/VertexDataManager.cpp',
    '../libANGLE/renderer/DeviceImpl.cpp',
    '../libANGLE/renderer/DisplayImpl.cpp',
    '../libANGLE/renderer/gl/BufferGL.cpp',
    '../libANGLE/renderer/gl/CompilerGL.cpp',
    '../libANGLE/renderer/gl/DisplayGL.cpp',
    '../libANGLE/renderer/gl/FenceNVGL.cpp',
    '../libANGLE/renderer/gl/FenceSyncGL.cpp',
    '../libANGLE/renderer/gl/formatutilsgl.cpp',
    '../libANGLE/renderer/gl/FramebufferGL.cpp',
    '../libANGLE/renderer/gl/FunctionsGL.cpp',
    '../libANGLE/renderer/gl/ProgramGL.cpp',
    '../libANGLE/renderer/gl/QueryGL.cpp',
    '../libANGLE/renderer/gl/RenderbufferGL.cpp',
    '../libANGLE/renderer/gl/RendererGL.cpp',
    '../libANGLE/renderer/gl/renderergl_utils.cpp',
    '../libANGLE/renderer/gl/ShaderGL.cpp',
    '../libANGLE/renderer/gl/StateManagerGL.cpp',
    '../libANGLE/renderer/gl/SurfaceGL.cpp',
    '../libANGLE/renderer/gl/TextureGL.cpp',
    '../libANGLE/renderer/gl/TransformFeedbackGL.cpp',
    '../libANGLE/renderer/gl/VertexArrayGL.cpp',
    '../libANGLE/renderer/gl/wgl/DisplayWGL.cpp',
    '../libANGLE/renderer/gl/wgl/FunctionsWGL.cpp',
    '../libANGLE/renderer/gl/wgl/PbufferSurfaceWGL.cpp',
    '../libANGLE/renderer/gl/wgl/wgl_utils.cpp',
    '../libANGLE/renderer/gl/wgl/WindowSurfaceWGL.cpp',
    '../libANGLE/renderer/ProgramImpl.cpp',
    '../libANGLE/renderer/Renderer.cpp',
    '../libANGLE/renderer/SurfaceImpl.cpp',
    '../libANGLE/ResourceManager.cpp',
    '../libANGLE/Sampler.cpp',
    '../libANGLE/Shader.cpp',
    '../libANGLE/State.cpp',
    '../libANGLE/Surface.cpp',
    '../libANGLE/Texture.cpp',
    '../libANGLE/TransformFeedback.cpp',
    '../libANGLE/Uniform.cpp',
    '../libANGLE/validationEGL.cpp',
    '../libANGLE/validationES.cpp',
    '../libANGLE/validationES2.cpp',
    '../libANGLE/validationES3.cpp',
    '../libANGLE/VertexArray.cpp',
    '../libANGLE/VertexAttribute.cpp',
    '../third_party/compiler/ArrayBoundsClamper.cpp',
    '../third_party/murmurhash/MurmurHash3.cpp',
    '../third_party/systeminfo/SystemInfo.cpp',
    'entry_points_egl.cpp',
    'entry_points_egl_ext.cpp',
    'entry_points_gles_2_0.cpp',
    'entry_points_gles_2_0_ext.cpp',
    'entry_points_gles_3_0.cpp',
    'entry_points_gles_3_0_ext.cpp',
    'global_state.cpp',
    'libGLESv2.cpp',
]
SOURCES += [
    '../compiler/translator/glslang_lex.cpp',
    '../compiler/translator/glslang_tab.cpp',
    '../libANGLE/Display.cpp',
    '../libANGLE/renderer/d3d/HLSLCompiler.cpp',
    '../libANGLE/renderer/d3d/loadimageSSE2.cpp',
]
SOURCES['../libANGLE/renderer/d3d/loadimageSSE2.cpp'].flags += CONFIG['SSE2_FLAGS']
if CONFIG['MOZ_HAS_WINSDK_WITH_D3D']:
    UNIFIED_SOURCES += [
        '../libANGLE/renderer/d3d/d3d11/Blit11.cpp',
        '../libANGLE/renderer/d3d/d3d11/Buffer11.cpp',
        '../libANGLE/renderer/d3d/d3d11/Clear11.cpp',
        '../libANGLE/renderer/d3d/d3d11/DebugAnnotator11.cpp',
        '../libANGLE/renderer/d3d/d3d11/dxgi_support_table.cpp',
        '../libANGLE/renderer/d3d/d3d11/Fence11.cpp',
        '../libANGLE/renderer/d3d/d3d11/formatutils11.cpp',
        '../libANGLE/renderer/d3d/d3d11/Framebuffer11.cpp',
        '../libANGLE/renderer/d3d/d3d11/Image11.cpp',
        '../libANGLE/renderer/d3d/d3d11/IndexBuffer11.cpp',
        '../libANGLE/renderer/d3d/d3d11/InputLayoutCache.cpp',
        '../libANGLE/renderer/d3d/d3d11/PixelTransfer11.cpp',
        '../libANGLE/renderer/d3d/d3d11/Query11.cpp',
        '../libANGLE/renderer/d3d/d3d11/Renderer11.cpp',
        '../libANGLE/renderer/d3d/d3d11/renderer11_utils.cpp',
        '../libANGLE/renderer/d3d/d3d11/RenderStateCache.cpp',
        '../libANGLE/renderer/d3d/d3d11/RenderTarget11.cpp',
        '../libANGLE/renderer/d3d/d3d11/ShaderExecutable11.cpp',
        '../libANGLE/renderer/d3d/d3d11/TextureStorage11.cpp',
        '../libANGLE/renderer/d3d/d3d11/Trim11.cpp',
        '../libANGLE/renderer/d3d/d3d11/VertexBuffer11.cpp',
        '../libANGLE/renderer/d3d/d3d11/win32/NativeWindow.cpp',
    ]
if CONFIG['MOZ_HAS_WINSDK_WITH_D3D']:
    SOURCES += [
        '../libANGLE/renderer/d3d/d3d11/SwapChain11.cpp',
    ]


if CONFIG['GNU_CXX']:
    CXXFLAGS += [
        '-Wno-attributes',
        '-Wno-sign-compare',
        '-Wno-unknown-pragmas',
    ]
    if CONFIG['CLANG_CXX']:
        CXXFLAGS += ['-Wno-unused-private-field']

if CONFIG['MOZ_DIRECTX_SDK_PATH'] and not CONFIG['MOZ_HAS_WINSDK_WITH_D3D']:
    CXXFLAGS += ['-I\'%s/include/\'' % CONFIG['MOZ_DIRECTX_SDK_PATH']]

DEFINES['NOMINMAX'] = True
DEFINES['_CRT_SECURE_NO_DEPRECATE'] = True
DEFINES['_HAS_EXCEPTIONS'] = 0

if not CONFIG['MOZ_DEBUG']:
    DEFINES['_SECURE_SCL'] = 0

DEFINES['ANGLE_ENABLE_D3D9'] = True
if CONFIG['MOZ_HAS_WINSDK_WITH_D3D']:
    DEFINES['ANGLE_ENABLE_D3D11'] = True

DEFINES['ANGLE_COMPILE_OPTIMIZATION_LEVEL'] = 'D3DCOMPILE_OPTIMIZATION_LEVEL1'
DEFINES['ANGLE_NO_EXCEPTIONS'] = True

# We need these defined to nothing so that we don't get bogus dllimport declspecs
DEFINES['GL_APICALL'] = ""
DEFINES['GL_GLEXT_PROTOTYPES'] = ""
DEFINES['EGLAPI'] = ""

ALLOW_COMPILER_WARNINGS = True

LOCAL_INCLUDES += [ '../../include', '../../src', '../../src/third_party/khronos' ]

DEFINES['LIBANGLE_IMPLEMENTATION'] = "1"
DEFINES['ANGLE_ENABLE_HLSL'] = "1"
DEFINES['ANGLE_ENABLE_KEYEDMUTEX'] = "1"

if CONFIG['MOZ_HAS_WINSDK_WITH_D3D']:
  OS_LIBS += [ 'd3d9', 'dxguid' ]
else:
  EXTRA_DSO_LDOPTS += [
    '\'%s/lib/%s/d3d9.lib\'' % (CONFIG['MOZ_DIRECTX_SDK_PATH'], CONFIG['MOZ_D3D_CPU_SUFFIX']),
    '\'%s/lib/%s/dxguid.lib\'' % (CONFIG['MOZ_DIRECTX_SDK_PATH'], CONFIG['MOZ_D3D_CPU_SUFFIX']),
  ]

GeckoSharedLibrary('libGLESv2', linkage=None)

RCFILE = SRCDIR + '/libGLESv2.rc'
DEFFILE = SRCDIR + '/libGLESv2.def'

SOURCES['../libANGLE/renderer/d3d/HLSLCompiler.cpp'].flags += ['-DANGLE_PRELOADED_D3DCOMPILER_MODULE_NAMES=\'{ TEXT("d3dcompiler_47.dll"), TEXT("d3dcompiler_46.dll"), TEXT("d3dcompiler_43.dll") }\'']

if CONFIG['MOZ_HAS_WINSDK_WITH_D3D']:
    SOURCES['../libANGLE/renderer/d3d/d3d11/SwapChain11.cpp'].flags += ['-DANGLE_RESOURCE_SHARE_TYPE=D3D11_RESOURCE_MISC_SHARED_KEYEDMUTEX']

